---
slug: "Spring-Web-General-02"
title: "[ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬] ê¸°ë³¸í¸ - 2"
description: "ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ - ì§ì ‘ ì½”ë“œë¥¼ ì‘ì„±í•´ ì™œ ìŠ¤í”„ë§ì´ í•„ìš”í•œì§€ ì•Œì•„ë³´ê¸°"
language: "Java"
category: "Spring Basic"
update: "2023-07-27"
hide: false
serisenumber: 2
---

## ì‹œì‘

- [ê¹€ì˜í•œ ê°•ì‚¬ë‹˜ì˜ ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ - ê¸°ë³¸í¸ ê°•ì˜ë¥¼ ë“£ê³  ì‘ì„±í•œ ê¸€ì…ë‹ˆë‹¤.](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%ED%95%B5%EC%8B%AC-%EC%9B%90%EB%A6%AC-%EA%B8%B0%EB%B3%B8%ED%8E%B8/dashboard)

## ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ ìƒì„±í•˜ê¸°
---
ìŠ¤í”„ë§ì˜ ë„ì›€ ì—†ì´ ìˆœìˆ˜ ìë°”ë¡œ ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ë¥¼ ê°œë°œí•´ë³´ê³  OCP, DIPê°€ ì˜ ì§€ì¼œì§€ê³  ìˆëŠ”ì§€ í™•ì¸í•´ë³´ì. 

## í™˜ê²½ êµ¬ì„±í•˜ê¸°
--- 
í”„ë¡œì íŠ¸ëŠ” ìë°”ë¡œë§Œ ì§„í–‰í•  ê²ƒ. í”„ë¡œì íŠ¸ ìƒì„±ì˜ ê²½ìš° ìŠ¤í”„ë§ì´ ì‰¬ìš°ë¯€ë¡œ í”„ë¡œì íŠ¸ë§Œ ìŠ¤í”„ë§ìœ¼ë¡œ ë§Œë“¤ë„ë¡ í•˜ì.

IntelliJë¥¼ ì‚¬ìš©í•œë‹¤ë©´ í™˜ê²½ì„¤ì • - Gradle - Gradle Projectë‚´ core ì—ì„œ `Build and run using`, `Run tests using`ì„ `IntelliJ IDEA`ë¥¼ ì ìš©í•´ì£¼ë©´ ë¹Œë“œ ë° ì‹¤í–‰ì„ ì¢€ ë” ë¹ ë¥´ê²Œ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.

## ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­
---
#### íšŒì›
- íšŒì› ê°€ì… í›„ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
- íšŒì›ì€ ì¼ë°˜/VIP ë“±ê¸‰ ì¡´ì¬
- íšŒì› ë°ì´í„°ëŠ” ìì²´ DBë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆê³ , ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ì—°ë™ ê°€ëŠ¥
#### ì£¼ë¬¸ê³¼ í• ì¸ ì •ì±…
- íšŒì›ì€ ìƒí’ˆì„ ì£¼ë¬¸í•  ìˆ˜ ìˆë‹¤.
- íšŒì› ë“±ê¸‰ì— ë”°ë¼ í• ì¸ ì •ì±…ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.
- í• ì¸ ì •ì±…ì˜ ê²½ìš° VIPëŠ” 1000ì›ì„ í• ì¸í•´ì£¼ê³  ê³ ì • ê¸ˆì•¡ í• ì¸ì„ ì ìš©í•´ì¤€ë‹¤.
- í• ì¸ ì •ì±…ì€ ë³€ê²½ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤. íšŒì‚¬ì˜ ê¸°ë³¸ í• ì¸ ì •ì±…ì„ ì•„ì§ ì •í•˜ì§€ ëª»í–ˆê³ , ì˜¤í”ˆ ì§ì „ê¹Œì§€ ê³ ë¯¼ì„ ë¯¸ë£¨ê³  ì‹¶ë‹¤. ìµœì•…ì˜ ê²½ìš° í• ì¸ì„ ì ìš©í•˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.

ìœ„ ìš”êµ¬ì‚¬í•­ì„ ë³´ë©´ íšŒì› ë°ì´í„°, í• ì¸ ì •ì±… ê°™ì€ ë¶€ë¶„ì€ ì§€ê¸ˆ ê²°ì •í•˜ê¸° ì–´ë ¤ìš´ ë¶€ë¶„ì´ë‹¤. ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ê³  êµ¬í˜„ì²´ë¥¼ ì–¸ì œë“  ê°ˆì•„ë¼ìš¸ ìˆ˜ ìˆë„ë¡ ì„¤ê³„í•˜ë©´ ëœë‹¤.

### íšŒì› ë„ë©”ì¸ ì„¤ê³„
---
íšŒì› ë„ë©”ì¸ ìš”êµ¬ì‚¬í•­
- íšŒì› ê°€ì… í›„ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
- íšŒì›ì€ ì¼ë°˜/VIP ë“±ê¸‰ ì¡´ì¬
- íšŒì› ë°ì´í„°ëŠ” ìì²´ DBë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆê³ , ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ì—°ë™ ê°€ëŠ¥

#### êµ¬í˜„
---
![Spring-Web-General-capture1](/snippets/springGeneral/section2/capture1.png)
íšŒì› ì„œë¹„ìŠ¤: MemberServiceImpl

ìš°ì„  ë©”ëª¨ë¦¬ ê³µê°„ì— íšŒì› ì •ë³´ë¥¼ ì €ì¥í•˜ê³  ì˜ êµ¬ë™ë˜ë©´ DBë¥¼ ì—°ë™í•˜ë„ë¡í•˜ì.

Grade Enum
```java
package hello.core.member;

public enum Grade {
    BASIC,
    VIP
}
```

- Member Class
```java
package hello.core.member;

public class Member {
    private Long id;
    private String name;
    private Grade grade;

    public Member(Long id, String name, Grade grade) {
        this.id = id;
        this.name = name;
        this.grade = grade;
    }

    public Long getId() {
        return id;
    }

    public String getName() {
        return name;
    }

    public Grade getGrade() {
        return grade;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public void setName(String name) {
        this.name = name;
    }

    public void setGrade(Grade grade) {
        this.grade = grade;
    }
}
```

- MemberRepository ì¸í„°í˜ì´ìŠ¤
```java
package hello.core.member;

public interface MemberRepository {
    void save(Member member);

    Member findById(Long memberId);
}
```

-  MemoryMemberRepository MemberRepository ë©”ëª¨ë¦¬ ì €ì¥ êµ¬í˜„ì²´
```java
package hello.core.member;

import java.util.HashMap;
import java.util.Map;

public class MemoryMemberRepository implements MemberRepository{

    private static Map<Long, Member> store = new HashMap<>(); // í–¥í›„ ë™ì‹œì„± ë¬¸ì œë¡œ ì¸í•´ ConcurrentMap ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

    @Override
    public void save(Member member) {
        store.put(member.getId(), member);
    }

    @Override
    public Member findById(Long memberId) {
        return store.get(memberId);
    }
}
```

> ğŸ’¡HashMapì˜ ë™ì‹œì„± ë¬¸ì œ
1. Thread-Safety ë¶€ì¬
- HashMapì€ thread-safeí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
- ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ë©´ ë°ì´í„° ì†ì‹¤ì´ë‚˜ ë¶ˆì¼ì¹˜ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
2. ë°œìƒ ê°€ëŠ¥í•œ ë¬¸ì œë“¤
- ë°ì´í„° ìœ ì‹¤
- ë¬´í•œ ë£¨í”„
- ë°ì´í„° ë¶ˆì¼ì¹˜
- ì˜ˆê¸°ì¹˜ ì•Šì€ NullPointerException
3. ConcurrentHashMapì˜ ì¥ì 
- Thread-Safe ë³´ì¥
    - ë‚´ë¶€ì ìœ¼ë¡œ ì„¸ê·¸ë¨¼íŠ¸ ë‹¨ìœ„ì˜ ë½ì„ ì‚¬ìš©
    - ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ë§µì„ ìˆ˜ì •í•´ë„ ì•ˆì „
- ì„±ëŠ¥ ìµœì í™”
    - ì „ì²´ ë§µì— ë½ì„ ê±¸ì§€ ì•Šê³  ì¼ë¶€ë¶„ë§Œ ë½ì„ ê±¸ì–´ ì²˜ë¦¬
    - HashMap + synchronized ë³´ë‹¤ í›¨ì”¬ ë” ë‚˜ì€ ì„±ëŠ¥ ì œê³µ
ì˜ˆì‹œ ì½”ë“œë¡œ ë³´ë©´:

```java
// Thread-safeí•˜ì§€ ì•ŠìŒ
private static Map<Long, Member> store = new HashMap<>();

// Thread-safeí•¨
private static Map<Long, Member> store = new ConcurrentHashMap<>();
```

ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œ ì—¬ëŸ¬ ì‚¬ìš©ìì˜ ìš”ì²­ì„ ë™ì‹œì— ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ìƒí™©ì´ë¼ë©´ ConcurrentHashMapì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•ˆì „í•©ë‹ˆë‹¤.

- MemberService Interface
```java
package hello.core.member;

public interface MemberService {

    void join(Member member);

    Member findMember(Long memberId);
}
```

- MemberServiceImpl
```java
package hello.core.member;

public class MemberServiceImpl implements MemberService {

    private final MemberRepository memberRepository = new MemoryMemberRepository();

    @Override
    public void join(Member member) {
        memberRepository.save(member);
    }

    @Override
    public Member findMember(Long memberId) {
        return memberRepository.findById(memberId);
    }
}
```

- í…ŒìŠ¤íŠ¸
```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;

public class MemberApp {

    public static void main(String[] args){
        MemberService memberService = new MemberServiceImpl();
        Member member = new Member(1L, "memberA", Grade.VIP);
        memberService.join(member);

        Member findMember = memberService.findMember(1L);
        System.out.println("new member = " + member.getName());
        System.out.println("find Member = " + findMember.getName());
    }
}
```

```bash
new member = memberA
find Member = memberA

Process finished with exit code 0
```

ì´ë²ˆì—ëŠ” junitì„ ì´ìš©í•œ í…ŒìŠ¤íŠ¸ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. í…ŒìŠ¤íŠ¸ì½”ë“œëŠ” ë¹Œë“œì‹œ ì œì™¸ë©ë‹ˆë‹¤.
```java
package member;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;

public class MemberServiceTest {

    MemberService memberService = new MemberServiceImpl();

    @Test
    void join(){
        // given
        Member member = new Member(1L, "memberA", Grade.VIP);

        // when
        memberService.join(member);
        Member findMember = memberService.findMember(1L);

        // then
        Assertions.assertThat(member).isEqualTo(findMember);
    }
}
```

##### íšŒì› ë„ë©”ì¸ ì„¤ê³„ì˜ ë¬¸ì œì 
---
- ë‹¤ë¥¸ ì €ì¥ì†Œë¡œ ë³€ê²½í•  ë•Œ OCP/DIP ì›ì¹™ì„ ì˜ ì¤€ìˆ˜í•˜ëŠ”ê°€?
- ì˜ì¡´ê´€ê³„ê°€ ì¸í„°í˜ì´ìŠ¤ ë¿ ì•„ë‹Œ êµ¬í˜„ì²´ê¹Œì§€ ëª¨ë‘ ì˜ì¡´í•˜ëŠ” ë¬¸ì œê°€ ì¡´ì¬í•˜ê³  ìˆìŒ.

MemberServiceImpl
```java {3-5}
package hello.core.member;

public class MemberServiceImpl implements MemberService {

    private final MemberRepository memberRepository = new MemoryMemberRepository();

    ...
```
MemberServiceImpl ëŠ” ì¸í„°í˜ì´ìŠ¤(MemberRepository) ë¿ ì•„ë‹ˆë¼ ì‹¤ì œ í• ë‹¹í•˜ëŠ” êµ¬í˜„ì²´(MemoryMemberRepository)ë¥¼ ì˜ì¡´í•œë‹¤. ì¶”ìƒí™”/êµ¬í˜„ì²´ ë‘˜ë‹¤ ì˜ì¡´í•˜ê³  ìˆê¸° ë•Œë¬¸ì— DIPë¥¼ ìœ„ë°˜í•˜ê³  ìˆë‹¤.

### ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ ì„¤ê³„
---
ë„ë©”ì¸ ìš”êµ¬ì‚¬í•­
- íšŒì›ì€ ìƒí’ˆì„ ì£¼ë¬¸í•  ìˆ˜ ìˆë‹¤.
- íšŒì› ë“±ê¸‰ì— ë”°ë¼ í• ì¸ ì •ì±…ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.
- í• ì¸ ì •ì±…ì˜ ê²½ìš° VIPëŠ” 1000ì›ì„ í• ì¸í•´ì£¼ê³  ê³ ì • ê¸ˆì•¡ í• ì¸ì„ ì ìš©í•´ì¤€ë‹¤.
- í• ì¸ ì •ì±…ì€ ë³€ê²½ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤. íšŒì‚¬ì˜ ê¸°ë³¸ í• ì¸ ì •ì±…ì„ ì•„ì§ ì •í•˜ì§€ ëª»í–ˆê³ , ì˜¤í”ˆ ì§ì „ê¹Œì§€ ê³ ë¯¼ì„ ë¯¸ë£¨ê³  ì‹¶ë‹¤. ìµœì•…ì˜ ê²½ìš° í• ì¸ì„ ì ìš©í•˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.

![Spring-Web-General-capture2](/snippets/springGeneral/section2/capture2.png)

![Spring-Web-General-capture3](/snippets/springGeneral/section2/capture3.png)

![Spring-Web-General-capture4](/snippets/springGeneral/section2/capture4.png)

![Spring-Web-General-capture5](/snippets/springGeneral/section2/capture5.png)

![Spring-Web-General-capture6](/snippets/springGeneral/section2/capture6.png)

#### êµ¬í˜„
---
ìš°ì„  ì •ì•¡ í• ì¸ ì •ì±…ìœ¼ë¡œ ì„¤ê³„í•˜ì—¬ ê°œë°œí•´ë³´ë„ë¡í•˜ì.

- order í´ë˜ìŠ¤
```java
package hello.core.order;

public class Order {

    private Long memberId;
    private String itemName;
    private int itemPrice;
    private int discountPrice;

    public Order(Long memberId, String itemName, int itemPrice, int discountPrice) {
        this.memberId = memberId;
        this.itemName = itemName;
        this.itemPrice = itemPrice;
        this.discountPrice = discountPrice;
    }

    public int calculatePrice() {
        return itemPrice - discountPrice;
    }

    public Long getMemberId() {
        return memberId;
    }

    public void setMemberId(Long memberId) {
        this.memberId = memberId;
    }

    public String getItemName() {
        return itemName;
    }

    public void setItemName(String itemName) {
        this.itemName = itemName;
    }

    public int getItemPrice() {
        return itemPrice;
    }

    public void setItemPrice(int itemPrice) {
        this.itemPrice = itemPrice;
    }

    public int getDiscountPrice() {
        return discountPrice;
    }

    public void setDiscountPrice(int discountPrice) {
        this.discountPrice = discountPrice;
    }

    @Override
    public String toString() {
        return "Order{" +
                "memberId=" + memberId +
                ", itemName='" + itemName + '\'' +
                ", itemPrice=" + itemPrice +
                ", discountPrice=" + discountPrice +
                '}';
    }
}
```

- OrderService Interface
```java
package hello.core.order;

public interface OrderService {
    Order createOrder(Long memberId, String itemName, int itemPrice); // Order ë°˜í™˜
}
```

OrderServiceImpl
```java {16-18}
package hello.core.order;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPolicy;
import hello.core.member.Member;
import hello.core.member.MemberRepository;
import hello.core.member.MemoryMemberRepository;

public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository = new MemoryMemberRepository();
    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        // ë‹¨ì¼ ì±…ì„ ì›ì¹™ì— ì˜í•´ discount ì •ì±…ì„ ì¡°íšŒí•˜ë ¤ë©´ discountPolicy ê°ì²´ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.
        Member member = memberRepository.findById(memberId);
        int discountPrice = discountPolicy.discount(member, itemPrice);

        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

- orderApp
```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.order.Order;
import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;

public class OrderApp {

    public static void main(String[] args) {
        MemberService memberService = new MemberServiceImpl();
        OrderService orderService = new OrderServiceImpl();

        Long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member); // ë©”ëª¨ë¦¬ ì €ì¥

        Order order = orderService.createOrder(memberId, "itemA", 10000);

        System.out.println("order = " + order);
    }
}
```

- junit Test
```java
import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;

public class OrderServiceTest {

    MemberService memberService = new MemberServiceImpl();
    OrderService orderService = new OrderServiceImpl();

    @Test
    void createOrder() {
        Long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 10000);
        Assertions.assertThat(order.getDiscountPrice()).isEqualTo(1000);
    }
}
```

```bash
Process finished with exit code 0
```

### ìš”êµ¬ì‚¬í•­ì˜ ë³€ê²½
---
ê¸°íšì¸¡ì˜ ìš”êµ¬ì‚¬í•­ ë³€ê²½ìœ¼ë¡œ í¼ì„¼íŠ¸ í• ì¸ìœ¼ë¡œ ì •ì±…ì„ ë°”ê¾¸ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

#### êµ¬í˜„
---
- êµ¬í˜„ ì½”ë“œ
```java
package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;

public class RateDiscountPolicy implements DiscountPolicy{

    private int discountPercent = 10;


    @Override
    public int discount(Member member, int price) {
        // Test ë§Œë“¤ê¸° command + shift + T
        if(member.getGrade() == Grade.VIP){
            return price * discountPercent / 100; // 10 %
        } else {
            return 0;
        }
    }
}
```

- Test Code
```java
package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

class RateDiscountPolicyTest {

    RateDiscountPolicy discountPolicy = new RateDiscountPolicy();

    @Test
    @DisplayName("VIPëŠ” 10% í• ì¸ì´ ì ìš©ë˜ì–´ì•¼ í•œë‹¤")
    void vip_o() {
        //given
        Member member = new Member(1L, "memberVIP", Grade.VIP);
        //when
        int discount = discountPolicy.discount(member, 10000);
        //then
        Assertions.assertThat(discount).isEqualTo(1000);
    }

    @Test
    @DisplayName("VIPê°€ ì•„ë‹ˆë©´ í• ì¸ì´ ì ìš©ë˜ì§€ ì•Šì•„ì•¼ í•œë‹¤")
    void vip_x() {
        //given
        Member member = new Member(2L, "memberBasic", Grade.BASIC);
        //when
        int discount = discountPolicy.discount(member, 10000);
        //then
        Assertions.assertThat(discount).isEqualTo(1000);
    }

}
```

![Spring-Web-General-capture7](/snippets/springGeneral/section2/capture7.png)

#### ì˜ì¡´ ê´€ê³„ì˜ ë¬¸ì œ
---
ë‹¤ì‹œ í…ŒìŠ¤í¬ ì½”ë“œë¥¼ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ë„ë¡ ìˆ˜ì •í•˜ê³  OrderServiceImplì˜ ì½”ë“œë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.
```java {4-5}
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository = new MemoryMemberRepository();
//    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        // ë‹¨ì¼ ì±…ì„ ì›ì¹™ì— ì˜í•´ discount ì •ì±…ì„ ì¡°íšŒí•˜ë ¤ë©´ discountPolicy ê°ì²´ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.
        Member member = memberRepository.findById(memberId);
        int discountPrice = discountPolicy.discount(member, itemPrice);

        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```
ìœ„ì—ì„œ ìš°ë ¤í–ˆë˜ ë¬¸ì œê°€ ë‹¤ì‹œ ë°œìƒí•©ë‹ˆë‹¤. í• ì¸ ì •ì±… ë³€ê²½ì„ ìœ„í•´ í´ë¼ì´ì–¸íŠ¸ì¸ `OrderServiceImpl`ì½”ë“œë¥¼ ê³ ì³ì•¼í•©ë‹ˆë‹¤.  

ì›ì¸ì„ ë˜ì§šì–´ ë´…ì‹œë‹¤.
- ì—­í• ê³¼ êµ¬í˜„ì„ ì¶©ì‹¤í•˜ê²Œ ë¶„ë¦¬í–ˆë‹¤? -> OK
- ë‹¤í˜•ì„±ì„ í™œìš©í•˜ê³ , ì¸í„°í˜ì´ìŠ¤ì™€ êµ¬í˜„ ê°ì²´ë¥¼ ë¶„ë¦¬í–ˆë‹¤ -> OK
- OCP, DIP ê°™ì€ ê°ì²´ì§€í–¥ ì„¤ê³„ ì›ì¹™ì„ ì¤€ìˆ˜í–ˆë‹¤? -> ê·¸ë ‡ê²Œ ë³´ì´ì§€ë§Œ ì‚¬ì‹¤ì€ ì•„ë‹ˆë‹¤.

![Spring-Web-General-capture8](/snippets/springGeneral/section2/capture8.png)

ì™œ í´ë¼ì´ì–¸íŠ¸ì˜ ì½”ë“œë¥¼ ë³€ê²½í•  ìˆ˜ ë°–ì— ì—†ëŠ”ì§€ ì•Œì•„ë´…ì‹œë‹¤.

![Spring-Web-General-capture9](/snippets/springGeneral/section2/capture9.png)

ì–´ë–»ê²Œ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆì„ê¹Œ

![Spring-Web-General-capture10](/snippets/springGeneral/section2/capture10.png)

ì½”ë“œë„ ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•˜ë„ë¡ ì½”ë“œë¥¼ ë³€ê²½í•´ì•¼í•©ë‹ˆë‹¤.

```java {4}
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository = new MemoryMemberRepository();
    private DiscountPolicy discountPolicy;

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        // ë‹¨ì¼ ì±…ì„ ì›ì¹™ì— ì˜í•´ discount ì •ì±…ì„ ì¡°íšŒí•˜ë ¤ë©´ discountPolicy ê°ì²´ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.
        Member member = memberRepository.findById(memberId);
        int discountPrice = discountPolicy.discount(member, itemPrice);

        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```
í•˜ì§€ë§Œ ìœ„ì™€ ê°™ì´ ì‹¤í–‰í•˜ë©´ `NullPointException`ì´ ë°œìƒí•©ë‹ˆë‹¤. ê²°êµ­ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´ í´ë¼ì´ì–¸íŠ¸ì¸ `OrderServiceImpl`ì— `DiscountPolicy`ì˜ êµ¬í˜„ ê°ì²´ë¥¼ ëŒ€ì‹  ìƒì„±í•˜ê³  ì£¼ì…í•´ì£¼ì–´ì•¼ í•œë‹¤.